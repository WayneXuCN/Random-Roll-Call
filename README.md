# 随机点名软件

适用于课堂教学场景的随机点名软件，具备Excel导入、随机抽取、历史记录等功能。

## 功能特性

- **Excel导入功能**：支持.xlsx和.xls格式文件导入学生姓名列表
- **随机点名功能**：基于高质量随机数算法的公平随机抽取
- **多学生点名**：支持1-20人同时点名
- **防重复机制**：可配置是否允许同一轮次中重复抽取同一学生
- **动画效果**：平滑的随机滚动动画效果
- **简洁UI**：蓝色系专业界面设计，适合教学场景
- **数据存储**：本地存储学生名单和点名历史
- **历史记录**：完整的点名记录和统计功能
- **数据验证**：导入时进行格式校验、重复检测和异常处理
- **异常处理**：完善的错误捕获和处理机制
- **手动管理**：支持手动添加/移除学生姓名，智能重名处理
- **菜单功能**：提供清空学生名单等高级功能

## 环境要求

- Python 3.9+
- uv 包管理器

## 安装与运行

### 使用uv管理虚拟环境

1. 克隆或下载项目
2. 安装依赖：
```bash
uv sync
```

3. 运行软件：
```bash
uv run python -m src.main
```

## 使用方法

1. 准备Excel模板文件，确保第一列包含学生姓名
2. 启动软件并点击"导入名单"按钮
3. 设置点名人数（1-20人）并选择是否启用防重复
4. 点击"开始点名"按钮，稍后点击"停止点名"获取结果
5. 查看历史记录和统计信息

## 项目结构

```
random_roll_call/
├── src/
│   ├── main.py          # 主程序入口，包含GUI界面和核心逻辑
│   └── excel_importer.py # Excel导入功能模块
├── data/                # 本地数据存储目录
│   ├── students.json    # 学生名单数据
│   ├── history.json     # 点名历史记录
│   └── config.json      # 应用配置
├── docs/                # 文档目录
│   └── user_guide.md    # 用户使用指南
├── template.xlsx        # Excel模板文件
├── pyproject.toml       # 项目配置文件
├── requirements.txt     # 依赖要求文件
├── README.md            # 项目说明文件
├── build.py             # 打包脚本
└── uv.lock              # 依赖锁定文件
```

## 技术栈

- GUI框架：PyQt6
- 数据处理：pandas, numpy
- Excel处理：openpyxl
- 构建工具：setuptools, uv

## 开发与测试

运行测试：
```bash
uv run pytest
```

格式化代码：
```bash
uv run black src/
```

## 打包为可执行文件

使用PyInstaller打包：
```bash
# 安装PyInstaller
uv run pip install pyinstaller

# 创建spec文件并打包
uv run python build.py
# 或直接使用
pyinstaller --onefile --windowed --name "随机点名系统" src/main.py
```

## 软件特性详情

### 1. 数据导入功能
- 支持.xlsx和.xls格式Excel文件
- 自动验证数据格式，检测重复姓名
- 提供导入成功/失败的明确反馈

### 2. 随机点名功能
- 基于Python内置random模块的公平随机算法
- 支持1-20人同时点名
- 可选防重复机制
- 平滑的随机滚动动画效果

### 3. 界面设计
- 简洁专业的蓝色系UI设计
- 响应式布局，适应不同分辨率
- 清晰的视觉反馈

### 4. 数据管理
- 本地JSON格式存储，无网络传输
- 自动生成备份，防止数据丢失
- 完整的历史记录功能

### 5. 性能保证
- 快速响应（点名操作<0.5秒）
- 支持最多1000名学生
- 低内存占用（<100MB）
- 长时间稳定运行

## 许可证

MIT License

## 联系方式

如需技术支持或反馈问题，请联系开发者。